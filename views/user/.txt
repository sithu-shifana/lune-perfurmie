<div class="container my-4">
  <h2 class="mb-4">Your Shopping Cart</h2>

  <!-- Cart Items List -->
  <div id="cartItems">
    <% if (cartItems && cartItems.length > 0) { %>
      <% cartItems.forEach(item => { %>
        <div class="card cart-item" data-item-id="<%= item._id %>" 
             data-offer-price="<%= item.offerPrice %>"
             data-original-price="<%= item.originalPrice %>">
          <a href="/product-show/<%= item.productId %>">
            <img src="<%= item.image %>" class="img-fluid rounded" alt="<%= item.name %>">
          </a>
          <div class="cart-item-content">
            <h5><%= item.productName %></h5>
            <div class="price-display">
              <div class="current-price">â‚¹<%= item.offerPrice.toLocaleString() %> each</div>
              <% if (item.hasOffer) { %>
                <div class="original-price">â‚¹<%= item.originalPrice.toLocaleString() %></div>
                <span class="discount">
                  <% if (item.discountType === 'percentage') { %>
                    <%= item.discountValue %>% OFF
                  <% } else if (item.discountType === 'flat') { %>
                    â‚¹<%= item.discountValue %> OFF
                  <% } %>
                </span>
                <div class="savings-amount">Save â‚¹<%= item.saving %> per item</div>
              <% } %>
            </div>
            <div class="quantity-section">
              <button class="btn btn-outline-secondary quantity-btn" 
                      onclick="changeQuantity('<%= item._id %>', -1)">âˆ’</button>
              <input type="number" class="form-control quantity-input" min="1" 
                     max="<%= item.maxStock %>" value="<%= item.quantity %>" 
                     onchange="inputQuantityChange('<%= item._id %>', this.value)" />
              <button class="btn btn-outline-secondary quantity-btn" 
                      onclick="changeQuantity('<%= item._id %>', 1)">ï¼‹</button>
            </div>
            <div class="item-total-section">
              <strong class="item-total">â‚¹<%= item.totalOriginal.toLocaleString() %></strong>
              <% if (item.hasOffer) { %>
                <div class="item-savings">You save â‚¹<%= item.totalSavings.toLocaleString() %></div>
              <% } %>
            </div>
          </div>
          <button class="btn btn-danger btn-sm" onclick="removeItem('<%= item.id %>')" 
                  title="Remove item">Ã—</button>
        </div>
      <% }) %>
    <% } else { %>
      <div class="empty-cart" id="emptyCart">
        <i class="bi bi-cart"></i>
        <p>No items in your Cart yet.</p>
        <a href="/products" class="btn">Browse Products</a>
      </div>
    <% } %>
  </div>

  <% if (cartItems && cartItems.length > 0) { %>
    <!-- Cart Summary -->
    <div class="card p-3">
      <h4>Order Summary</h4>
      <div class="d-flex justify-content-between">
        <span>Subtotal:</span>
        <span id="subtotal">â‚¹<%= subtotal.toLocaleString() %></span>
      </div>
      <% if (totalSavings > 0) { %>
        <div class="savings-highlight">
          <div class="d-flex justify-content-between">
            <span>ðŸŽ‰ Your Total Savings:</span>
            <span id="totalSavings">-â‚¹<%= totalSavings.toLocaleString() %></span>
          </div>
        </div>
      <% } %>
      <hr>
      <div class="d-flex justify-content-between fs-5 fw-bold">
        <span>Final Total:</span>
        <span id="total">â‚¹<%= subtotal.toLocaleString() %></span>
      </div>
      <div class="mt-3 d-flex justify-content-between">
        <button class="btn btn-outline-danger" onclick="clearCart()">Clear Cart</button>
        <button class="btn btn-primary" onclick="proceedToCheckout()">Proceed to Checkout</button>
      </div>
    </div>
  <% } %>
</div>